lapply(c("RSAGA", "terra", "usethis", "devtools","sp","raster","lattice","rgdal","gstat",
              "shapefiles","foreign"), require, character.only = TRUE)



#library(devtools) #require to accses gitHUB Packages repository 


# Read Raster using "raster"
DEM <- raster("E:/Collage/GEOGRAFI UM/SM 7/Reseach Project/Pacet/QGIS/Final Landslide Conditioning Factors/Elevasi.tif")
DEM <- projectRaster(DEM,
                     crs="+proj=utm +zone=49 +south +datum=WGS84 +units=m +no_defs")
DEM

# Change 0 value to NA
values(DEM)[values(DEM) == 0] = NA
plot(DEM)

# Setwd
setwd("E:/APRIL/Skill Training/R/Automation/RSAGA")

# Setting RSAGA ENV
env <- rsaga.env("C:/Program Files/saga-8.2.1_x64/")
rsaga.get.version(env)

# write Tiff to .sgrd to perform raster in RSAGA
writeRaster(DEM, filename="DEM.sgrd", format="SAGA", overwrite=TRUE)

# List of Module in RSAGA
rsaga.get.modules("ta_morphometry", env=env)

# Produce Spatial Parameters
## Slope, Aspect, Plan Curvature, & Profile Curvature
rsaga.geoprocessor("ta_morphometry", 0, list( ELEVATION = "DEM,sgrd",
                                              SLOPE = "Slope",
                                              ASPECT = "Aspect",
                                              C_PLAN = "Plan Curvature",
                                              C_PROF = "Profile Curvature", 
                                              METHOD = 0), env = env)

## Topographic Position Index
rsaga.geoprocessor("ta_morphometry", 18, list( DEM = "sgrd",
                                               TPI = "Topographic Position Index"),
                   env=env)

## Topographic Wetness Index
rsaga.wetness.index("DEM.sgrd", out.wetness.index = "Topographic Wetness Index", env=env)
