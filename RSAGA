lapply(c("RSAGA", "terra", "usethis", "devtools","sp","raster","lattice","rgdal","gstat",
              "shapefiles","foreign"), require, character.only = TRUE)



#library(devtools) #require to accses gitHUB Packages repository 


# Read Raster using "raster"
DEM <- raster("E:/Collage/GEOGRAFI UM/SM 7/Reseach Project/Pacet/QGIS/Final Landslide Conditioning Factors/Elevasi.tif")
DEM <- projectRaster(DEM,
                     crs="+proj=utm +zone=49 +south +datum=WGS84 +units=m +no_defs")
DEM

# Change 0 value to NA
values(DEM)[values(DEM) == 0] = NA
plot(DEM)

# Setwd
setwd("E:/APRIL/Skill Training/R/Automation/RSAGA")

# Setting RSAGA ENV
env <- rsaga.env("C:/Program Files/saga-6.3.0_x64")
rsaga.get.version(env)

# write Tiff to .sgrd to perform raster in RSAGA
writeRaster(DEM, filename="DEM.sgrd", format="SAGA", overwrite=TRUE)

# List of Module in RSAGA
rsaga.get.modules(interactive = TRUE, env=env)
rsaga.get.usage("ta_hydrology", 20, show = TRUE, env=env)

# Produce Spatial Parameters
## Slope, Aspect, Plan Curvature, & Profile Curvature
rsaga.geoprocessor("ta_morphometry", 0, list( ELEVATION = "DEM.sgrd",
                                              SLOPE = "Slope",
                                              ASPECT = "Aspect",
                                              UNIT_SLOPE = 1,
                                              UNIT_ASPECT = 1,
                                              METHOD = 6), 
                   env = env)

## Topographic Position Index
rsaga.geoprocessor("ta_morphometry", 18, list( DEM = "DEM.sgrd",
                                               TPI = "Topographic Position Index",
                                               DW_WEIGHTING = 0),
                   env=env)

## Topographic Wetness Index
rsaga.wetness.index("DEM.sgrd", out.wetness.index = "Topographic Wetness Index", env=env)
